---
title: "Simulation - Test Analysis"
date: Last compiled on `r format(Sys.time(), '%B-%d-%Y')`
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
rm(list = ls())
```

# Load libraries

```{r}
# install.packages(pacman)
library(pacman)

p_load(tidyverse,
       readxl,
       lme4,
       nlme,
       lmerTest,
       psych,
       sjPlot) #Add additional packages



```

# Load data

```{r, echo = TRUE, results = "hide"}
setwd("simulations/") # Change WD for loading files
temp <- list.files(pattern = "\\.RData") # Load all .RData files in folder 

lapply(temp, load, .GlobalEnv)

```

# Confirmatory Analyses

```{r}

#---- Model list for Confirmatory Analyses ----
model_list.C <- list()

```

## Model type 1) Mixed Models

### Smartness

```{r}

# ---- Smartness comparison 7.8 & 7.5 ---- 
model_list.C[["H1_Model.1"]] <- nlme::lme(
  fixed = Y ~ Condition * Contrast,
  random = ~ 1 + Contrast | Subject,
  data = df_S_1,
  method = "ML"
)

# ---- Smartness comparison 6.6 & 6.3 ----
model_list.C[["H1_Model.2"]] <- nlme::lme(
  fixed = Y ~ Condition * Contrast,
  random = ~ 1 + Contrast | Subject,
  data = df_S_2,
  method = "ML"
)

```

### Perceived Similarity

```{r}

# ---- Similarity ----
model_list.C[["H2a_Model.1"]] <- nlme::lme(
  fixed = Y ~ Condition,
  random = ~ 1 | Subject,
  data = df_PS_1,
  method = "ML"
)

# ---- Commonality ----
model_list.C[["H2b_Model.1"]] <- nlme::lme(
  fixed = Y ~ Condition,
  random = ~ 1 | Subject,
  data = df_PS_2,
  method = "ML"
)

```

### Closeness

```{r}

model_list.C[["H3_Model.1"]] <- nlme::lme(
  fixed = Y ~ Condition,
  random = ~ 1 | Subject,
  data = df_C,
  method = "ML"
)

```

## Model type 2) Linear Models

## Attributions - High Performance

```{r}
# ---- Internal - Smart ----
model_list.C[["H4a_Model.1"]] <- lm(Attributions_HP_1 ~ Condition, data = df_sim)

# ---- External - Luck ----
model_list.C[["H4b_Model.1"]] <- lm(Attributions_HP_3 ~ Condition, data = df_sim)

```

## Stability - High Performance

```{r}
# ---- Smart parents ----
model_list.C[["H5a_Model.1"]] <- lm(Stability_HP_1 ~ Condition, data = df_sim)

# ---- Early emergence ----
model_list.C[["H5b_Model.1"]] <- lm(Stability_HP_2 ~ Condition, data = df_sim)

# ---- Smart future job ----
model_list.C[["H5c_Model.1"]] <- lm(Stability_HP_3 ~ Condition, data = df_sim)

```

## Attributions - Low Performance

```{r}
# ---- Internal - Smart ----
model_list.C[["H4a_Model.1"]] <- lm(Attributions_LP_1 ~ Condition, data = df_sim)

# ---- External - Luck ----
model_list.C[["H4b_Model.1"]] <- lm(Attributions_LP_3 ~ Condition, data = df_sim)

```

## Stability - Low Performance

```{r}
# ---- Smart parents ----
model_list.C[["H5a_Model.1"]] <- lm(Stability_LP_1 ~ Condition, data = df_sim)

# ---- Early emergence ----
model_list.C[["H5b_Model.1"]] <- lm(Stability_LP_2 ~ Condition, data = df_sim)

# ---- Smart future job ----
model_list.C[["H5c_Model.1"]] <- lm(Stability_LP_3 ~ Condition, data = df_sim)

```

# Exploratory Analyses

In this stage, only the following exploratory analyses are worked out:

-   Exploratory Smartness hypothesis

-   Exploratory Dependent variables (Hard work - attribution & Future financial success)

-   Exploratory random effects

The following exploratory analyses will be worked out as part of the paper:

-   Exploratory Moderation analyses

-   Confirmatory Factor Analysis

```{r}
#---- Model list for Exploratory Analyses
model_list.E <- list()

```

## Exploratory Smartness hypothesis
```{r}
# ---- Smartness comparison 7.5 & 6.6 ----
model_list.E[["EH_Model.1"]] <- nlme::lme(
  fixed = Y ~ Condition * Contrast,
  random = ~ 1 + Contrast | Subject,
  data = df_S_3,
  method = "ML"
)

```

## Exploratory Dependent Variables
```{r}
# ---- Stability - Future Financial Success ----
model_list.E[["EDV1_HP_Model.1"]] <- lm(Stability_HP_4 ~ Condition, data = df_sim)
model_list.E[["EDV1_LP_Model.1"]] <- lm(Stability_LP_4 ~ Condition, data = df_sim)

# ---- External - Hard Work ----
model_list.E[["EDV2_HP_Model.1"]] <- lm(Attributions_HP_2 ~ Condition, data = df_sim)
model_list.E[["EDV2_LP_Model.1"]] <- lm(Attributions_LP_2 ~ Condition, data = df_sim)

```

## Exploratory Random Effects

### Perceived Similarity

```{r}

# ---- Similarity ----
model_list.E[["H2a_Model.1"]] <- nlme::lme(
  fixed = Y ~ Condition * Contrast,
  random = ~ 1 + Contrast | Subject,
  data = df_PS_1,
  method = "ML"
)

# ---- Commonality ----
model_list.E[["H2b_Model.1"]] <- nlme::lme(
  fixed = Y ~ Condition * Contrast,
  random = ~ 1 + Contrast | Subject,
  data = df_PS_2,
  method = "ML"
)

```

### Closeness

```{r}

model_list.E[["H3_Model.1"]] <- nlme::lme(
  fixed = Y ~ Condition * Contrast,
  random = ~ 1 + Contrast | Subject,
  data = df_C,
  method = "ML"
)

```


### TO BE EXPANDED???
```{r}

# model_list.E[["H4a_Model.1"]] <- nlme::lme(
#   fixed = Y ~ Condition * Contrast,
#   random = ~ 1 + Contrast | Subject,
#   data = df_A_1,
#   method = "ML"
# )

```

